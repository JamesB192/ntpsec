= TO DO =

== Checklist for a quality first release ==

=== Blocker bugs ===

None right now. (Sep-22 2015)


=== Build system ===

* Document build files.

* Cleanup and separate features in pylib/*

* Add 'snapshot' feature to dump config status into a JSON file for collecting 
  build + platform information

* scripts/*/*.in and scripts/ntpsweep.in need to be expanded into the
actual scripts by substituting in @-cookies.

* The install production needs to warn of stale ntpdc and ntpdate binaries.

* The following symbols need to be investigated to determine under what
circumstances configuration should set them.

HAVE_AUDIO
HAVE_BINTIME
HAVE_CATGETS
HAVE_DNSREGISTRATION
HAVE_IO_COMPLETION_PORT
HAVE_KVM_OPEN
HAVE_LIBCTRACE
HAVE_LIBXML2
HAVE_LINUX_CAPABILITIES
HAVE_PACKET_TIMESTAMP
HAVE_PTHREAD_ATTR_GETSTACKSIZE
HAVE_RTPRIO
HAVE_SYSCTLBYNAME
HAVE_TIMESTAMP
HAVE_TIMESTAMPNS
HAVE_TRUCLUSTER
NEED_HPUX_ADJTIME
NEED_NETSNMP_DAEMONIZE
NEED_SRANDOMDEV
OPENSSL_LEAKS
TM_IN_SYS_TIME
TRIM_POLLRATE

=== Code ===

* The u_* types in ntp.h are GCCisms that should be replaced with POSIX types.

* We should audit scripts/ and utils/ to see which of those programs can
  be thrown out.

Hal:
> I think there is some interaction between when the ACTS driver calls and the 
> state of other stuff, like the connection to the net.  This is probably a 
> good candidate to get cleaned up.
> 
> There is another possible tangle in this area.  If you set "noselect" on the 
> server line in the config file, ntpd goes through all the action of 
> collecting the data and writing log files, but then drops the clock.  I don't 
> know things well enough to be sure that this sort of logic won't pick one 
> back up.

=== Porting ===

* The ntpd initialization sequence is still full of platform-
specific crud.

** We might be able to eliminate a lot of the Linux runtime
droproot code by using file capabilities.

* Better ANSI/POSIX conformance in MinGW and Visual Studio 2013 might
enable us to get rid of the SYS_WINNT code. Should be tried...

=== Testing ===

* Unit testing.  "make check" needs to run all the unit tests.

* Build testing.  The build/CI farm needs to be fully operational.

* Live testing.  Somebody needs to take the development branch,
build it on a real machines, and live-test it to make sure that
it issues sane corrections and doesn't core-dump or barf.
We need to do that on various platforms.

* We also need to live-test various refclocks.  It would be nice
to test the full matrix of refclock x platform, but that's too
much work.  We should probably test as many refclocks as we can
on at least one platform and test the NMEA, Atom, and SHM drivers
on most platforms.

* We need to live-test leap seconds, both getting them from
a file and getting them from other NTP servers.

* Option testing.  The new, non-autogen option-processing logic
is not yet tested anywhere but in ntpd itself.

=== Documentation ===

* man pages outside of docs/ need to be merged with the
  Mills manpages inside it, with duplications removed.  In the
  list below, the original docs content is on the left and
  the external man pages are on the right.
+
[options="header"]
|===========================================================
| Inside docs       | Outside docs
| docs/ntp_conf.txt | ntpd/ntp.conf.txt
| docs/ntpdsim.txt  | docs/ntpdsim_new.txt
| docs/ntpd.txt     | ntpd/ntpd.txt
| docs/ntpq.txt     | ntpq/ntpq.txt
| docs/ntptime.txt  | -
| docs/ntptrace.txt | scripts/ntptrace/ntptrace.txt
| docs/ntpwait.txt  | scripts/ntp-wait/ntp-wait.txt
| docs/sntp.txt     | sntp/sntp.txt
| docs/tickadj.txt  | -
| -                 | ntpsnmpd/ntpsnmpd.txt
| -                 | ntpd/ntp.keys.txt
| -                 | scripts/calc_tickadj/calc_tickadj.txt
| -                 | scripts/summary.txt
| -                 | scripts/ntpsweep/ntpsweep.txt
| -                 | scripts/plot_summary.txt
| -                 | scripts/update-leap/update-leap.txt
|===========================================================

* Also, any exterior documents retained need to be parametrized
  with the macros in docs/asciidoc.conf. and the asciidoc build rules
  need to use that.

* In the docs subdirectory, include/command.txt is an HTML passthrough
  in a not entirely successful attempt to emulate the look of the
  Mills HTML documentation this directory was made from. It should be
  cleaned up or replaced.

* Similarly, includes/footer.txt is a tabular hack made to resemble the
  old HTML and should be cleaned up.

* A serious content-editing and update pass on the exterior documents is needed.

* Part of d) is the ntp -> ntps name change.

* The format and organization of the NEWS file needs a rethink.

* Phabricator-centered workflow needs to be written up and integrated
  with the website content I wrote for us.

* Website needs to be integrated (with a contacts and services page,
  among other things) and published.

=== Remaining procedural issues ===

* The dev changes need to be fed through through Phabricator,
reviewed, and if necessary fixed.

* Version-numbering policy needs to be decided and written up.

* We need a release checklist.

== Old, sometime ancient stuff ==

      *** IF YOU CAN HELP FIX ANY OF THESE THINGS, PLEASE DO! ***

970711: Look Real Hard at changing the key stuff from u_long to u_int32.

970711: Make sure it's safe to convert proto_config's 2nd argument from
	u_long to u_int32.  Watch "set" in ntp_request.c:setclr_flags().

970318: in hourly_stats(?), squawk if the magnitude of the drift is,
	say, >400.

970301: Implement the utmp/wtmp timestamping on time steps.

Problems that need to be fixed:

- Combine enable-step-slew and enable-ntpdate-step

- Check dcfd.c for variables that need to be volatile.
